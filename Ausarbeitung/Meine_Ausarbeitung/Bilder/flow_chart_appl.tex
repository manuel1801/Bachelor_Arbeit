\tikzset{
    decision/.style={
        diamond,
        draw,
        text width=4em,
        %minimum width=4em,
        text badly centered,
        inner sep=-1pt,
        node distance=8em
    },
    block/.style={
        rectangle,
        draw,
        text width=6em,
        minimum height=2.5em,
        text centered,
        rounded corners,
        node distance=8em
    },
    arrow/.style={
        draw,
        >=latex,
        ->
    }
}


\begin{tikzpicture}

    \node (main) {\underline{main.py}};
    \node (detection) [right of=main, node distance=0.5\textwidth] {\underline{detection.py}};
    \node (connection) [left of=main, node distance=0.25\textwidth] {\underline{connection.py}};

    \node (frame) [block, below of=main, text width=5em] {Video\\Capture};
    \node (motion) [decision, below of=frame] {has\\Motion};
    \node (buffer) [block, right of=motion, node distance=0.25\textwidth] {Buffer};
    \node (infer) [block, right of=buffer, node distance=0.25\textwidth] {Inferenz};
    \node (threshhold) [decision, below of=infer] {resp.p\\$>$det.p};
    \node (detframes) [block, below of=threshhold] {cls, p, N, Roi};
    \node (nodet) [decision, below of=buffer] {no det\\$>$ 20};
    \node (ndet) [decision, below of=detframes] {N\\$>$10};
    \node (save) [block, left of=ndet] {save frame};
    \node (connected) [decision, left of=save, node distance=0.25\textwidth, inner sep=1pt] {connected};

    \node (connect) [block, left of=connected, node distance=0.25\textwidth] {connect};

    \node (send) [block, above of=connect] {send};


    % \node (false) [left of=connected, node distance=0.15\textwidth] {false};

    
    \draw[arrow] (frame) -- node [fill=white] {Frame} (motion);
    \draw[arrow] (motion) -- node [above] {true} (buffer);
    \draw[arrow] (buffer) -- (infer);
    \draw[arrow] (infer) -- (threshhold);
    \draw[arrow] (threshhold) -- node [fill=white] {true} (detframes);
    \draw[arrow] (threshhold) -- node [above] {false} (nodet);
    \draw[arrow] (nodet) -| node [near start, above] {reset} (motion);
    \draw[arrow] (save) -- node [above] {sendReq} (connected);
    \draw[arrow] (connected) -- node [above] {false} (connect);
    \draw[arrow] (connected) |- node [near start, fill=white] {true} (send);
    \draw[arrow] (connect) -- (send);
    \draw[arrow] (send)|- (frame);

    \draw[arrow] (detframes) -- (ndet);
    \draw[arrow] (ndet) -- (save);



    %\node (connected) [decision, left of=saved, node distance=0.4\textwidth] {Connec\\ed};
    % \node (B) [block, below of=A, node distance=3cm, text width=5em] {bock};
    % \node (C) [block, right of=A, node distance=0.5\textwidth] {noch ein\\bock};


    % \draw[arrow] (A) --  node [left, fill=white!30] {yes} (B);
    % \draw[arrow] (A) -- node [below, near end] {crap} (C); 
    % \draw[arrow] (B) -| node [near start, fill=white] {yes} (C);

\end{tikzpicture}

